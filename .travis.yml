language: php

services:
  - docker

php:
  - '7.2'

git:
  depth: 1

before_install:
  - composer install
  - vendor/unb-libraries/dockworker/scripts/travis/init.sh

script:
  - set -e
  - vendor/bin/dockworker local:build-test
  - vendor/unb-libraries/dockworker/scripts/kubectl/init.sh
  - vendor/bin/dockworker image:deploy $TRAVIS_BRANCH
  - vendor/bin/dockworker deployment:logs:check $TRAVIS_BRANCH

notifications:
  slack:
    rooms:
      secure: EiosZ9cd6zVGdfLvnW3NHkS7MCasJDwhWORp0ccyLvtOvonoA9SsMLYInlPx3VkwvD/lGPZKTua3B7r9LJmjFfvGCgAg5BVrUwEpCYs5nwcnsKoXXg91kuS9JEbT1UuHsDuavq/mn93o2EB0WyAlHv0WubIrjLurtXBL8+At5tt5wezzb8Q2ssJIhiQdtGY9rAPFDg44NS7XAXq0V/71G4b6kIgYw0Muv8RQvWPDBPlVoOGpa3y/AVxEc/xZbOuTC/eQYWW+pYXosUvEGl0dHXt8NzofORBHqx+8psK9KWNRQJVlbrzh94wASU/WT/OpnCZ1tSWDdKEVI6wadTHA4CEuHaTGsTIAQXq8xj8mpbUgYVU96/4KOTK700HHN3094r6dnw3AcBMxtYfIsrWdzSsyCJ7V8i0zd4AVVwaEE4iyMIElA1ylmFjIz6abjruWlQz/fSASeYvRR5KpxK80ZmCGoeJA9FKsQc8oEZ8ktfqx66QGnqLPZpCx9gTw13KQRWPTtdL6WBhO4Q8etTRjoOzzqdm2RSi2N4I0flAjbJkKoGbahhL5FC/GFhXPHLTk7NbTvYbs0pMXguSnr+IzbZF6QdyfNh50yEWnK/M+4/NSx55AUM4pIot895xiB9MI4pGqPY1yxPlwG5/iJfakVXhHytCUob4ghqr9fjqJMmw=
    on_start: always
    on_success: always
